{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport React, { useEffect, useState } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Pressable from \"react-native-web/dist/exports/Pressable\";\nimport { collection, onSnapshot, query, orderBy, doc, updateDoc } from 'firebase/firestore';\nimport { db, serverTime } from \"../firebase\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function ParkingScreen() {\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    violations = _useState2[0],\n    setViolations = _useState2[1];\n  var _useState3 = useState(true),\n    _useState4 = _slicedToArray(_useState3, 2),\n    loading = _useState4[0],\n    setLoading = _useState4[1];\n  useEffect(function () {\n    var q = query(collection(db, 'parkingViolations'), orderBy('createdAt', 'desc'));\n    var unsub = onSnapshot(q, function (snap) {\n      var items = snap.docs.map(function (d) {\n        return _objectSpread({\n          id: d.id\n        }, d.data());\n      });\n      setViolations(items);\n      setLoading(false);\n    }, function (err) {\n      console.error(err);\n      setLoading(false);\n    });\n    return function () {\n      return unsub();\n    };\n  }, []);\n  var approve = function () {\n    var _ref = _asyncToGenerator(function* (id) {\n      try {\n        var dref = doc(db, 'parkingViolations', id);\n        yield updateDoc(dref, {\n          approved: true,\n          approvedAt: serverTime()\n        });\n      } catch (err) {\n        console.error(err);\n        alert('Approve failed');\n      }\n    });\n    return function approve(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  return _jsxs(ScrollView, {\n    style: {\n      flex: 1,\n      padding: 16\n    },\n    children: [_jsx(Text, {\n      style: {\n        fontSize: 20,\n        fontWeight: '600',\n        marginBottom: 8\n      },\n      children: \"Parking Violations\"\n    }), loading && _jsx(Text, {\n      children: \"Loading...\"\n    }), violations.map(function (v) {\n      return _jsxs(View, {\n        style: {\n          backgroundColor: '#fff',\n          padding: 12,\n          borderRadius: 12,\n          marginBottom: 12,\n          borderWidth: 1,\n          borderColor: v.approved ? '#d1fae5' : '#fee2e2'\n        },\n        children: [_jsx(Text, {\n          style: {\n            fontWeight: '600'\n          },\n          children: v.licensePlate || '—'\n        }), _jsx(Text, {\n          style: {\n            color: '#6b7280'\n          },\n          children: v.vehicleOwner || '—'\n        }), _jsx(Text, {\n          style: {\n            marginTop: 8\n          },\n          children: v.dateTime || ''\n        }), !v.approved && _jsx(Pressable, {\n          onPress: function onPress() {\n            return approve(v.id);\n          },\n          style: {\n            marginTop: 8,\n            backgroundColor: '#2563eb',\n            padding: 8,\n            borderRadius: 8\n          },\n          children: _jsx(Text, {\n            style: {\n              color: '#fff'\n            },\n            children: \"Approve\"\n          })\n        }), v.approved && _jsx(Text, {\n          style: {\n            color: '#10b981',\n            marginTop: 8\n          },\n          children: \"Approved\"\n        })]\n      }, v.id);\n    })]\n  });\n}","map":{"version":3,"names":["React","useEffect","useState","View","Text","ScrollView","Pressable","collection","onSnapshot","query","orderBy","doc","updateDoc","db","serverTime","jsx","_jsx","jsxs","_jsxs","ParkingScreen","_useState","_useState2","_slicedToArray","violations","setViolations","_useState3","_useState4","loading","setLoading","q","unsub","snap","items","docs","map","d","_objectSpread","id","data","err","console","error","approve","_ref","_asyncToGenerator","dref","approved","approvedAt","alert","_x","apply","arguments","style","flex","padding","children","fontSize","fontWeight","marginBottom","v","backgroundColor","borderRadius","borderWidth","borderColor","licensePlate","color","vehicleOwner","marginTop","dateTime","onPress"],"sources":["C:/Users/ashri/Downloads/campus-sentryapp/src/screens/ParkingScreen.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { View, Text, ScrollView, Pressable } from 'react-native';\nimport { collection, onSnapshot, query, orderBy, doc, updateDoc } from 'firebase/firestore';\nimport { db, serverTime } from '../firebase';\n\nexport default function ParkingScreen() {\n  const [violations, setViolations] = useState<any[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const q = query(collection(db, 'parkingViolations'), orderBy('createdAt', 'desc'));\n    const unsub = onSnapshot(q, (snap) => {\n      const items = snap.docs.map(d => ({ id: d.id, ...(d.data() as any) }));\n      setViolations(items);\n      setLoading(false);\n    }, (err) => {\n      console.error(err);\n      setLoading(false);\n    });\n    return () => unsub();\n  }, []);\n\n  const approve = async (id: string) => {\n    try {\n      const dref = doc(db, 'parkingViolations', id);\n      await updateDoc(dref, { approved: true, approvedAt: serverTime() });\n    } catch (err) { console.error(err); alert('Approve failed'); }\n  };\n\n  return (\n    <ScrollView style={{ flex: 1, padding: 16 }}>\n      <Text style={{ fontSize: 20, fontWeight: '600', marginBottom: 8 }}>Parking Violations</Text>\n      {loading && <Text>Loading...</Text>}\n      {violations.map(v => (\n        <View key={v.id} style={{ backgroundColor: '#fff', padding: 12, borderRadius: 12, marginBottom: 12, borderWidth: 1, borderColor: v.approved ? '#d1fae5' : '#fee2e2' }}>\n          <Text style={{ fontWeight: '600' }}>{v.licensePlate || '—'}</Text>\n          <Text style={{ color: '#6b7280' }}>{v.vehicleOwner || '—'}</Text>\n          <Text style={{ marginTop: 8 }}>{v.dateTime || ''}</Text>\n          {!v.approved && <Pressable onPress={() => approve(v.id)} style={{ marginTop: 8, backgroundColor: '#2563eb', padding: 8, borderRadius: 8 }}><Text style={{ color: '#fff' }}>Approve</Text></Pressable>}\n          {v.approved && <Text style={{ color: '#10b981', marginTop: 8 }}>Approved</Text>}\n        </View>\n      ))}\n    </ScrollView>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}